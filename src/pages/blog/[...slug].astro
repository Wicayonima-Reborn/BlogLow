---
import { getCollection } from "astro:content";
import BaseHead from "../../components/BaseHead.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import FormattedDate from "../../components/FormattedDate.astro";

/**
 * Static paths WAJIB untuk static output
 */
export async function getStaticPaths() {
  const posts = await getCollection("blog");

  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const html = post.rendered?.html;
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead
      title={post.data.title}
      description={post.data.description ?? ""}
    />
  </head>
  <body>
    <Header />

    <main>
      <article>
        <h1>{post.data.title}</h1>

        <p>
          <FormattedDate date={post.data.pubDate} />
        </p>

        {html ? (
          <div class="content" set:html={html} />
        ) : (
          <p>Content not found.</p>
        )}
      </article>
    </main>

    <Footer />
  </body>
</html>